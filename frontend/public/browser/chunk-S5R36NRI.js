import{e as y}from"./chunk-A5KRNXOI.js";import{Ea as h,Fa as L,Ha as _,O as C,W as b,X as v,Y as P,Z as I}from"./chunk-KGPGTJJF.js";var u=class{constructor(){this.change=new _,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}defaultId(){return this.DEFAULT_ID}register(n){return n.id==null&&(n.id=this.DEFAULT_ID),this.instances[n.id]?this.updateInstance(n):(this.instances[n.id]=n,!0)}updateInstance(n){let e=!1;for(let t in this.instances[n.id])n[t]!==this.instances[n.id][t]&&(this.instances[n.id][t]=n[t],e=!0);return e}getCurrentPage(n){return this.instances[n]?this.instances[n].currentPage:1}setCurrentPage(n,e){if(this.instances[n]){let t=this.instances[n],r=Math.ceil(t.totalItems/t.itemsPerPage);e<=r&&1<=e&&(this.instances[n].currentPage=e,this.change.emit(n))}}setTotalItems(n,e){this.instances[n]&&0<=e&&(this.instances[n].totalItems=e,this.change.emit(n))}setItemsPerPage(n,e){this.instances[n]&&(this.instances[n].itemsPerPage=e,this.change.emit(n))}getInstance(n=this.DEFAULT_ID){return this.instances[n]?this.clone(this.instances[n]):{}}clone(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},S=Number.MAX_SAFE_INTEGER,le=(()=>{class s{constructor(e){this.service=e,this.state={}}transform(e,t){if(!(e instanceof Array)){let g=t.id||this.service.defaultId();return this.state[g]?this.state[g].slice:e}let r=t.totalItems&&t.totalItems!==e.length,i=this.createInstance(e,t),a=i.id,o,l,p=i.itemsPerPage,d=this.service.register(i);if(!r&&e instanceof Array){if(p=+p||S,o=(i.currentPage-1)*p,l=o+p,this.stateIsIdentical(a,e,o,l))return this.state[a].slice;{let m=e.slice(o,l);return this.saveState(a,e,m,o,l),this.service.change.emit(a),m}}else return d&&this.service.change.emit(a),this.saveState(a,e,e,o,l),e}createInstance(e,t){return this.checkConfig(t),{id:t.id!=null?t.id:this.service.defaultId(),itemsPerPage:+t.itemsPerPage||0,currentPage:+t.currentPage||1,totalItems:+t.totalItems||e.length}}checkConfig(e){let r=["itemsPerPage","currentPage"].filter(i=>!(i in e));if(0<r.length)throw new Error(`PaginatePipe: Argument is missing the following required properties: ${r.join(", ")}`)}saveState(e,t,r,i,a){this.state[e]={collection:t,size:t.length,slice:r,start:i,end:a}}stateIsIdentical(e,t,r,i){let a=this.state[e];return!a||!(a.size===t.length&&a.start===r&&a.end===i)?!1:a.slice.every((l,p)=>l===t[r+p])}}return s.\u0275fac=function(e){return new(e||s)(h(u,16))},s.\u0275pipe=P({name:"paginate",type:s,pure:!1}),s})();var pe=(()=>{class s{constructor(e,t){this.service=e,this.changeDetectorRef=t,this.maxSize=7,this.pageChange=new _,this.pageBoundsCorrection=new _,this.pages=[],this.changeSub=this.service.change.subscribe(r=>{this.id===r&&(this.updatePageLinks(),this.changeDetectorRef.markForCheck(),this.changeDetectorRef.detectChanges())})}ngOnInit(){this.id===void 0&&(this.id=this.service.defaultId()),this.updatePageLinks()}ngOnChanges(e){this.updatePageLinks()}ngOnDestroy(){this.changeSub.unsubscribe()}previous(){this.checkValidId(),this.setCurrent(this.getCurrent()-1)}next(){this.checkValidId(),this.setCurrent(this.getCurrent()+1)}isFirstPage(){return this.getCurrent()===1}isLastPage(){return this.getLastPage()===this.getCurrent()}setCurrent(e){this.pageChange.emit(e)}getCurrent(){return this.service.getCurrentPage(this.id)}getLastPage(){let e=this.service.getInstance(this.id);return e.totalItems<1?1:Math.ceil(e.totalItems/e.itemsPerPage)}getTotalItems(){return this.service.getInstance(this.id).totalItems}checkValidId(){this.service.getInstance(this.id).id==null&&console.warn(`PaginationControlsDirective: the specified id "${this.id}" does not match any registered PaginationInstance`)}updatePageLinks(){let e=this.service.getInstance(this.id),t=this.outOfBoundCorrection(e);t!==e.currentPage?setTimeout(()=>{this.pageBoundsCorrection.emit(t),this.pages=this.createPageArray(e.currentPage,e.itemsPerPage,e.totalItems,this.maxSize)}):this.pages=this.createPageArray(e.currentPage,e.itemsPerPage,e.totalItems,this.maxSize)}outOfBoundCorrection(e){let t=Math.ceil(e.totalItems/e.itemsPerPage);return t<e.currentPage&&0<t?t:e.currentPage<1?1:e.currentPage}createPageArray(e,t,r,i){i=+i;let a=[],o=Math.max(Math.ceil(r/t),1),l=Math.ceil(i/2),p=e<=l,d=o-l<e,g=!p&&!d,m=i<o,c=1;for(;c<=o&&c<=i;){let f,x=this.calculatePageNumber(c,e,i,o),k=c===2&&(g||d),w=c===i-1&&(g||p);m&&(k||w)?f="...":f=x,a.push({label:f,value:x}),c++}return a}calculatePageNumber(e,t,r,i){let a=Math.ceil(r/2);return e===r?i:e===1?e:r<i?i-a<t?i-r+e:a<t?t-a+e:e:e}}return s.\u0275fac=function(e){return new(e||s)(h(u),h(L))},s.\u0275dir=v({type:s,selectors:[["pagination-template"],["","pagination-template",""]],inputs:{id:"id",maxSize:"maxSize"},outputs:{pageChange:"pageChange",pageBoundsCorrection:"pageBoundsCorrection"},exportAs:["paginationApi"],features:[I]}),s})();var ge=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=b({type:s}),s.\u0275inj=C({providers:[u],imports:[[y]]}),s})();export{le as a,pe as b,ge as c};
